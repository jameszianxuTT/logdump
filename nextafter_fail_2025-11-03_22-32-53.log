WARNING:root:Defaulting to PJRT_DEVICE=CPU
Using TT-Metal from the source tree: /localdev/jameszianxu/tt-xla/third_party/tt-mlir/src/tt-mlir/third_party/tt-metal/src/tt-metal
WARNING: TT plugin is setting XLA_STABLEHLO_COMPILE to 1. This is required for TT PJRT plugin to work correctly.
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.4.2, pluggy-1.6.0 -- /localdev/jameszianxu/tt-xla/venv/bin/python
cachedir: .pytest_cache
rootdir: /localdev/jameszianxu/tt-xla
configfile: pytest.ini
plugins: anyio-4.11.0, jaxtyping-0.3.3, forked-1.6.0, split-0.10.0, loop-1.0.13
collecting ... collected 1 item

tests/torch/single_chip/ops/test_eltwise_binary_ops.py::test_nextafter 2025-11-03 22:31:29.360 (   0.000s) [        6ED2D000]   plugin_attributes.cc:58       1| PluginAttributes::PJRT_Plugin_Initialize
2025-11-03 22:31:29.360 (   0.000s) [        6ED2D000]     client_instance.cc:482      1| ClientInstance::PJRT_Client_Create
2025-11-03 22:31:29.367 (   0.007s) [        6ED2D000]     client_instance.cc:44       1| ClientInstance::ClientInstance
2025-11-03 22:31:29.367 (   0.007s) [        6ED2D000]     client_instance.cc:73       1| ClientInstance::Initialize
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]              stubs.inc:103   WARN| STUB: PJRT_Client_TopologyDescription
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]      error_instance.cc:52       1| ErrorInstance::PJRT_Error_Message
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]      error_instance.cc:61       1| ErrorInstance::PJRT_Error_GetCode
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]      error_instance.cc:46       1| ErrorInstance::PJRT_Error_Destroy
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     client_instance.cc:530      1| ClientInstance::PJRT_Client_PlatformVersion
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     client_instance.cc:511      1| ClientInstance::PJRT_Client_PlatformName
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     client_instance.cc:541      1| ClientInstance::PJRT_Client_Devices
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     device_instance.cc:44       1| DeviceInstance::PJRT_Device_GetDescription
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]  device_description.cc:63       1| DeviceDescription::PJRT_DeviceDescription_Attributes
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     client_instance.cc:554      1| ClientInstance::PJRT_Client_AddressableDevices
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     client_instance.cc:604      1| ClientInstance::PJRT_Client_AddressableMemories
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     device_instance.cc:71       1| DeviceInstance::PJRT_Device_AddressableMemories
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     memory_instance.cc:124      1| MemoryInstance::PJRT_Memory_AddressableByDevices
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]     memory_instance.cc:124      1| MemoryInstance::PJRT_Memory_AddressableByDevices
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]   plugin_attributes.cc:64       1| PluginAttributes::PJRT_Plugin_Attributes
2025-11-03 22:31:33.472349: W torch_xla/csrc/runtime/profiler.cpp:88] Profiler API not found for PJRT plugin
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]  device_description.cc:99       1| DeviceDescription::PJRT_DeviceDescription_ToString
2025-11-03 22:31:33.472 (   4.112s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.473 (   4.113s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.473 (   4.113s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.473 (   4.113s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.473 (   4.113s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:33.475 (   4.115s) [        6ED2D000]     device_instance.cc:82       1| DeviceInstance::PJRT_Device_DefaultMemory
2025-11-03 22:31:33.475 (   4.115s) [        6ED2D000]     client_instance.cc:660      1| ClientInstance::PJRT_Client_BufferFromHostBuffer
2025-11-03 22:31:33.475 (   4.115s) [        6ED2D000]     memory_instance.cc:57       1| MemoryInstance::getDevice
2025-11-03 22:31:33.475 (   4.115s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:33.475 (   4.116s) [        6ED2D000]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
2025-11-03 22:31:33.476 (   4.116s) [        6ED2D000]     device_instance.cc:82       1| DeviceInstance::PJRT_Device_DefaultMemory
2025-11-03 22:31:33.476 (   4.116s) [        6ED2D000]     client_instance.cc:660      1| ClientInstance::PJRT_Client_BufferFromHostBuffer
2025-11-03 22:31:33.476 (   4.116s) [        6ED2D000]     memory_instance.cc:57       1| MemoryInstance::getDevice
2025-11-03 22:31:33.476 (   4.116s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:33.476 (   4.116s) [        6ED2D000]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
tensor([[ 1.4609,  0.2910,  0.9609,  1.5703,  0.4941, -1.5156, -0.2500,  0.5742,
          0.3262, -0.5664,  0.5430, -0.5625,  0.6016,  2.3750,  1.6719, -0.8359,
         -0.5039, -0.5078, -0.4355,  1.3672, -0.6719, -0.1108,  0.8945, -1.3359,
          0.7656,  1.1484, -0.5742,  0.9609,  2.0312,  0.5625,  0.2002, -0.6992]],
       dtype=torch.bfloat16)
tensor([[-0.4707, -1.3906,  1.3828, -0.6133,  2.9531,  0.6523, -1.3516, -1.4844,
          0.9883,  1.1875, -2.0156, -1.5938, -0.9609,  0.5625, -0.6836, -0.7500,
          0.9219,  0.3691,  0.4961, -1.4141, -0.1748,  1.5938,  0.2969, -0.4863,
          0.8789, -1.4062, -0.1436, -0.8867, -0.2031, -0.1030, -1.1328,  0.1738]],
       dtype=torch.bfloat16)
[JAMES] Calling XLAExecutor
2025-11-03 22:31:33.683 (   4.323s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:33.683 (   4.323s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:33.683 (   4.323s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:33.683 (   4.323s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:33.683664: W torch_xla/csrc/runtime/pjrt_computation_client.cpp:703] Failed to deserialize executable: UNIMPLEMENTED: Deserializing serialized executable not supported.
2025-11-03 22:31:33.683 (   4.323s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:33.683 (   4.323s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:33.689 (   4.329s) [        6ED2D000]     client_instance.cc:617      1| ClientInstance::PJRT_Client_Compile
2025-11-03 22:31:33.689 (   4.329s) [        6ED2D000]      module_builder.cc:220      1| ModuleBuilder::buildModule
2025-11-03 22:31:33.690 (   4.330s) [        6ED2D000]      module_builder.cc:963      1| MLIR Module vhlo:
#loc1 = loc("p0.1")
#loc2 = loc("p1.5")
module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false} {
  vhlo.func_v1 @main(%arg0: !vhlo.tensor_v1<1x32x!vhlo.bf16_v1> loc("p0.1"), %arg1: !vhlo.tensor_v1<1x32x!vhlo.bf16_v1> loc("p1.5")) -> (!vhlo.tensor_v1<1x32x!vhlo.bf16_v1>, !vhlo.tensor_v1<1x32x!vhlo.bf16_v1>) {
    %0 = "vhlo.reshape_v1"(%arg0) : (!vhlo.tensor_v1<1x32x!vhlo.bf16_v1>) -> !vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1> loc(#loc3)
    %1 = "vhlo.custom_call_v1"(%0) <{api_version = #vhlo<api_version_v1 API_VERSION_UNSPECIFIED>, backend_config = #vhlo.string_v1<"">, call_target_name = #vhlo.string_v1<"tt.mark_argument">, called_computations = #vhlo.array_v1<[]>, has_side_effect = #vhlo.bool_v1<false>, operand_layouts = #vhlo.array_v1<[]>, output_operand_aliases = #vhlo.array_v1<[]>, result_layouts = #vhlo.array_v1<[]>}> {mhlo.frontend_attributes = #vhlo.dict_v1<{#vhlo.string_v1<"ttcore.argument_type"> = #vhlo.string_v1<"input">, #vhlo.string_v1<"ttir.name"> = #vhlo.string_v1<"args_1">}>} : (!vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1>) -> !vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1> loc(#loc4)
    %2 = "vhlo.reshape_v1"(%1) : (!vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1>) -> !vhlo.tensor_v1<1x32x!vhlo.bf16_v1> loc(#loc5)
    %3 = "vhlo.reshape_v1"(%arg1) : (!vhlo.tensor_v1<1x32x!vhlo.bf16_v1>) -> !vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1> loc(#loc6)
    %4 = "vhlo.custom_call_v1"(%3) <{api_version = #vhlo<api_version_v1 API_VERSION_UNSPECIFIED>, backend_config = #vhlo.string_v1<"">, call_target_name = #vhlo.string_v1<"tt.mark_argument">, called_computations = #vhlo.array_v1<[]>, has_side_effect = #vhlo.bool_v1<false>, operand_layouts = #vhlo.array_v1<[]>, output_operand_aliases = #vhlo.array_v1<[]>, result_layouts = #vhlo.array_v1<[]>}> {mhlo.frontend_attributes = #vhlo.dict_v1<{#vhlo.string_v1<"ttcore.argument_type"> = #vhlo.string_v1<"input">, #vhlo.string_v1<"ttir.name"> = #vhlo.string_v1<"args_0">}>} : (!vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1>) -> !vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1> loc(#loc7)
    %5 = "vhlo.reshape_v1"(%4) : (!vhlo.tensor_v1<1x1x32x!vhlo.bf16_v1>) -> !vhlo.tensor_v1<1x32x!vhlo.bf16_v1> loc(#loc8)
    "vhlo.return_v1"(%2, %5) : (!vhlo.tensor_v1<1x32x!vhlo.bf16_v1>, !vhlo.tensor_v1<1x32x!vhlo.bf16_v1>) -> () loc(#loc)
  } {arg_attrs = #vhlo.array_v1<[]>, res_attrs = #vhlo.array_v1<[]>, sym_visibility = #vhlo.string_v1<"">} loc(#loc)
} loc(#loc)
#loc = loc(unknown)
#loc3 = loc("reshape.2")
#loc4 = loc("custom-call.3")
#loc5 = loc("reshape.4")
#loc6 = loc("reshape.6")
#loc7 = loc("custom-call.7")
#loc8 = loc("reshape.8")
------------------ END OF MLIR MODULE ------------------
2025-11-03 22:31:33.694 (   4.334s) [        6ED2D000]      module_builder.cc:963      1| MLIR Module shlo:
#loc1 = loc("p0.1")
#loc2 = loc("p1.5")
module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false} {
  func.func @main(%arg0: tensor<1x32xbf16> loc("p0.1"), %arg1: tensor<1x32xbf16> loc("p1.5")) -> (tensor<1x32xbf16>, tensor<1x32xbf16>) {
    %0 = stablehlo.reshape %arg0 : (tensor<1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc3)
    %1 = stablehlo.custom_call @tt.mark_argument(%0) {api_version = 0 : i32, mhlo.frontend_attributes = {ttcore.argument_type = "input", ttir.name = "args_1"}} : (tensor<1x1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc4)
    %2 = stablehlo.reshape %1 : (tensor<1x1x32xbf16>) -> tensor<1x32xbf16> loc(#loc5)
    %3 = stablehlo.reshape %arg1 : (tensor<1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc6)
    %4 = stablehlo.custom_call @tt.mark_argument(%3) {api_version = 0 : i32, mhlo.frontend_attributes = {ttcore.argument_type = "input", ttir.name = "args_0"}} : (tensor<1x1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc7)
    %5 = stablehlo.reshape %4 : (tensor<1x1x32xbf16>) -> tensor<1x32xbf16> loc(#loc8)
    return %2, %5 : tensor<1x32xbf16>, tensor<1x32xbf16> loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc = loc(unknown)
#loc3 = loc("reshape.2")
#loc4 = loc("custom-call.3")
#loc5 = loc("reshape.4")
#loc6 = loc("reshape.6")
#loc7 = loc("custom-call.7")
#loc8 = loc("reshape.8")
------------------ END OF MLIR MODULE ------------------
2025-11-03 22:31:33.696 (   4.336s) [        6ED2D000]      module_builder.cc:963      1| MLIR Module shlo_frontend:
#loc1 = loc("p0.1")
#loc2 = loc("p1.5")
module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false} {
  func.func @main(%arg0: tensor<1x32xbf16> {ttcore.argument_type = #ttcore.argument_type<input>, ttir.name = "args_1"} loc("p0.1"), %arg1: tensor<1x32xbf16> {ttcore.argument_type = #ttcore.argument_type<input>, ttir.name = "args_0"} loc("p1.5")) -> (tensor<1x32xbf16>, tensor<1x32xbf16>) {
    %0 = stablehlo.reshape %arg0 : (tensor<1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc3)
    %1 = stablehlo.reshape %0 : (tensor<1x1x32xbf16>) -> tensor<1x32xbf16> loc(#loc4)
    %2 = stablehlo.reshape %arg1 : (tensor<1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc5)
    %3 = stablehlo.reshape %2 : (tensor<1x1x32xbf16>) -> tensor<1x32xbf16> loc(#loc6)
    return %1, %3 : tensor<1x32xbf16>, tensor<1x32xbf16> loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc = loc(unknown)
#loc3 = loc("reshape.2")
#loc4 = loc("reshape.4")
#loc5 = loc("reshape.6")
#loc6 = loc("reshape.8")
------------------ END OF MLIR MODULE ------------------
2025-11-03 22:31:33.700 (   4.340s) [        6ED2D000]      module_builder.cc:963      1| MLIR Module shlo_compiler:
#loc1 = loc("p0.1")
#loc2 = loc("p1.5")
module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false} {
  sdy.mesh @mesh = <["x"=1, "y"=1]> loc(#loc)
  func.func @main(%arg0: tensor<1x32xbf16> {ttcore.argument_type = #ttcore.argument_type<input>, ttcore.shard_status = #ttcore.shard_status<unsharded>, ttir.name = "args_1"} loc("p0.1"), %arg1: tensor<1x32xbf16> {ttcore.argument_type = #ttcore.argument_type<input>, ttcore.shard_status = #ttcore.shard_status<unsharded>, ttir.name = "args_0"} loc("p1.5")) -> (tensor<1x32xbf16> {ttcore.shard_status = #ttcore.shard_status<unsharded>}, tensor<1x32xbf16> {ttcore.shard_status = #ttcore.shard_status<unsharded>}) {
    %0 = stablehlo.reshape %arg0 : (tensor<1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc3)
    %1 = stablehlo.reshape %0 : (tensor<1x1x32xbf16>) -> tensor<1x32xbf16> loc(#loc4)
    %2 = stablehlo.reshape %arg1 : (tensor<1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc5)
    %3 = stablehlo.reshape %2 : (tensor<1x1x32xbf16>) -> tensor<1x32xbf16> loc(#loc6)
    return %1, %3 : tensor<1x32xbf16>, tensor<1x32xbf16> loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc = loc(unknown)
#loc3 = loc("reshape.2")
#loc4 = loc("reshape.4")
#loc5 = loc("reshape.6")
#loc6 = loc("reshape.8")
------------------ END OF MLIR MODULE ------------------
2025-11-03 22:31:33.702 (   4.342s) [        6ED2D000]      module_builder.cc:963      1| MLIR Module ttir:
#loc1 = loc("p0.1")
#loc2 = loc("p1.5")
module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false, ttcore.meshes = #ttcore.meshes<[<"mesh" = 1x1>]>} {
  func.func @main(%arg0: tensor<1x32xbf16> {ttcore.argument_type = #ttcore.argument_type<input>, ttcore.shard_status = #ttcore.shard_status<unsharded>, ttir.name = "args_1"} loc("p0.1"), %arg1: tensor<1x32xbf16> {ttcore.argument_type = #ttcore.argument_type<input>, ttcore.shard_status = #ttcore.shard_status<unsharded>, ttir.name = "args_0"} loc("p1.5")) -> (tensor<1x32xbf16> {ttcore.shard_status = #ttcore.shard_status<unsharded>}, tensor<1x32xbf16> {ttcore.shard_status = #ttcore.shard_status<unsharded>}) {
    %0 = ttir.empty() : tensor<1x1x32xbf16> loc(#loc3)
    %1 = "ttir.reshape"(%arg0, %0) <{shape = [1 : i32, 1 : i32, 32 : i32]}> : (tensor<1x32xbf16>, tensor<1x1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc3)
    %2 = ttir.empty() : tensor<1x32xbf16> loc(#loc4)
    %3 = "ttir.reshape"(%1, %2) <{shape = [1 : i32, 32 : i32]}> : (tensor<1x1x32xbf16>, tensor<1x32xbf16>) -> tensor<1x32xbf16> loc(#loc4)
    %4 = ttir.empty() : tensor<1x1x32xbf16> loc(#loc5)
    %5 = "ttir.reshape"(%arg1, %4) <{shape = [1 : i32, 1 : i32, 32 : i32]}> : (tensor<1x32xbf16>, tensor<1x1x32xbf16>) -> tensor<1x1x32xbf16> loc(#loc5)
    %6 = ttir.empty() : tensor<1x32xbf16> loc(#loc6)
    %7 = "ttir.reshape"(%5, %6) <{shape = [1 : i32, 32 : i32]}> : (tensor<1x1x32xbf16>, tensor<1x32xbf16>) -> tensor<1x32xbf16> loc(#loc6)
    return %3, %7 : tensor<1x32xbf16>, tensor<1x32xbf16> loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc = loc(unknown)
#loc3 = loc("reshape.2")
#loc4 = loc("reshape.4")
#loc5 = loc("reshape.6")
#loc6 = loc("reshape.8")
------------------ END OF MLIR MODULE ------------------
2025-11-03 22:31:33.703 (   4.343s) [        6ED2D000]      module_builder.cc:774   WARN| `mhlo.num_partitions` attribute not found, assuming default number of partitions: 1
2025-11-03 22:31:33.703 (   4.343s) [        6ED2D000]      module_builder.cc:788   WARN| `mhlo.num_replicas` attribute not found, assuming default number of replicas: 1
2025-11-03 22:31:33.703 (   4.343s) [        6ED2D000]      module_builder.cc:798   WARN| Num replicas and num partitions are not set, inferring the number of devices from mesh shape
2025-11-03 22:31:33.704 (   4.344s) [        6ED2D000]     client_instance.cc:375      1| ClientInstance::getOrCreateMeshDevice - reusing already opened mesh device [1, 1]
2025-11-03 22:31:33.704 (   4.344s) [        6ED2D000]     client_instance.cc:472      1| ClientInstance::getOrCreateOptimizerSubmesh - creating optimizer submesh
2025-11-03 22:31:33.715 (   4.355s) [        6ED2D000]      module_builder.cc:963      1| MLIR Module ttnn:
#dram = #ttnn.buffer_type<dram>
#loc1 = loc("p0.1")
#loc2 = loc("p1.5")
#system_desc = #ttcore.system_desc<[{role = host, target_triple = "x86_64-pc-linux"}], [{arch = <wormhole_b0>, grid = 8x8, coord_translation_offsets = 18x18, l1_size = 1499136, num_dram_channels = 12, dram_channel_size = 1073741824, noc_l1_address_align_bytes = 16, pcie_address_align_bytes = 32, noc_dram_address_align_bytes = 32, l1_unreserved_base = 101664, erisc_l1_unreserved_base = 98304, dram_unreserved_base = 32, dram_unreserved_end = 1073131840, supported_data_types = [<f32>, <f16>, <bf16>, <bfp_f8>, <bfp_bf8>, <bfp_f4>, <bfp_bf4>, <bfp_f2>, <bfp_bf2>, <u32>, <u16>, <u8>, <si32>], supported_tile_sizes = [ 4x16,  16x16,  32x16,  4x32,  16x32,  32x32], dst_physical_size_tiles = 16, num_cbs = 32, num_compute_threads = 1, num_datamovement_threads = 2}], [0], [1 : i32], [ 0x0x0x0]>
#ttnn_layout = #ttnn.ttnn_layout<(d0, d1) -> (d0, d1), <1x1>, memref<1x1x!ttcore.tile<32x32, bf16>, #dram>, <interleaved>>
module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false, ttcore.meshes = #ttcore.meshes<[<"mesh" = 1x1>]>} {
  ttcore.device_module {
    builtin.module @SyncTensorsGraph.10 attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false, ttcore.meshes = #ttcore.meshes<[<"mesh" = 1x1>]>, ttcore.system_desc = #system_desc} {
      ttcore.device @default_device = <workerGrid = #ttcore.grid<8x8, (d0, d1) -> (0, d0, d1)>, l1Map = (d0, d1, d2)[s0] -> (0, d0, d1, d2 + s0), dramMap = (d0, d1, d2)[s0, s1, s2, s3, s4, s5, s6] -> (0, 0, (((d0 * s1) * (s2 * (s3 * s6)) + d1 * (s2 * (s3 * s6)) + d2) floordiv s4) mod 12, ((((d0 * s1) * (s2 * (s3 * s6)) + d1 * (s2 * (s3 * s6)) + d2) floordiv s4) floordiv 12) * s4 + ((d0 * s1) * (s2 * (s3 * s6)) + d1 * (s2 * (s3 * s6)) + d2) mod s4 + s5), meshShape = 1x1, chipIds = [0]> loc(#loc)
      func.func @main(%arg0: tensor<1x32xbf16, #ttnn_layout> {ttcore.argument_type = #ttcore.argument_type<input>, ttcore.shard_status = #ttcore.shard_status<unsharded>, ttir.name = "args_1"} loc("p0.1"), %arg1: tensor<1x32xbf16, #ttnn_layout> {ttcore.argument_type = #ttcore.argument_type<input>, ttcore.shard_status = #ttcore.shard_status<unsharded>, ttir.name = "args_0"} loc("p1.5")) -> (tensor<1x32xbf16, #ttnn_layout> {ttcore.shard_status = #ttcore.shard_status<unsharded>}, tensor<1x32xbf16, #ttnn_layout> {ttcore.shard_status = #ttcore.shard_status<unsharded>}) {
        return %arg0, %arg1 : tensor<1x32xbf16, #ttnn_layout>, tensor<1x32xbf16, #ttnn_layout> loc(#loc)
      } loc(#loc)
    } loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc = loc(unknown)
------------------ END OF MLIR MODULE ------------------
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000]loaded_executable_insta:70       1| LoadedExecutableInstance::PJRT_LoadedExecutable_GetExecutable
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000]loaded_executable_insta:89       1| LoadedExecutableInstance::PJRT_LoadedExecutable_AddressableDevices
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000]              stubs.inc:70    WARN| STUB: PJRT_Executable_GetCompiledMemoryStats
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000]      error_instance.cc:52       1| ErrorInstance::PJRT_Error_Message
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000]      error_instance.cc:61       1| ErrorInstance::PJRT_Error_GetCode
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000]      error_instance.cc:46       1| ErrorInstance::PJRT_Error_Destroy
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000] executable_instance.cc:108      1| ExecutableInstance::PJRT_Executable_OptimizedProgram
2025-11-03 22:31:33.717 (   4.357s) [        6ED2D000] executable_instance.cc:108      1| ExecutableInstance::PJRT_Executable_OptimizedProgram
2025-11-03 22:31:33.721 (   4.361s) [        6ED2D000] executable_instance.cc:108      1| ExecutableInstance::PJRT_Executable_OptimizedProgram
2025-11-03 22:31:33.721 (   4.361s) [        6ED2D000] executable_instance.cc:108      1| ExecutableInstance::PJRT_Executable_OptimizedProgram
2025-11-03 22:31:33.723 (   4.363s) [        6ED2D000] executable_instance.cc:234      1| ExecutableInstance::PJRT_Executable_Serialize
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640]     device_instance.cc:53       1| DeviceInstance::PJRT_Device_IsAddressable
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640]     buffer_instance.cc:610      1| BufferInstance::PJRT_Buffer_Device
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640]     buffer_instance.cc:610      1| BufferInstance::PJRT_Buffer_Device
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640] executable_instance.cc:140      1| ExecutableInstance::PJRT_Executable_NumOutputs
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640]loaded_executable_insta:125      1| LoadedExecutableInstance::PJRT_LoadedExecutable_Execute
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640]flatbuffer_loaded_execu:443      1| FlatbufferLoadedExecutableInstance::Execute
2025-11-03 22:31:33.732 (   4.372s) [        4E79C640]     client_instance.cc:375      1| ClientInstance::getOrCreateMeshDevice - reusing already opened mesh device [1, 1]
2025-11-03 22:31:34.554 (   5.194s) [        4E79C640]flatbuffer_loaded_execu:378      1| Filled output at output_index 0 device_index 0 with shape [1, 32]
2025-11-03 22:31:34.554 (   5.194s) [        4E79C640]flatbuffer_loaded_execu:378      1| Filled output at output_index 1 device_index 0 with shape [1, 32]
2025-11-03 22:31:34.554 (   5.194s) [        4E79C640]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:34.554 (   5.194s) [        4E79C640]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
2025-11-03 22:31:34.554 (   5.194s) [        4E79C640]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:34.554 (   5.195s) [        4E79C640]     buffer_instance.cc:496      1| BufferInstance::PJRT_Buffer_DynamicDimensionIndices
2025-11-03 22:31:34.555 (   5.195s) [        4E79C640]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:34.555 (   5.195s) [        4E79C640]     buffer_instance.cc:465      1| BufferInstance::PJRT_Buffer_ElementType
2025-11-03 22:31:34.555 (   5.195s) [        4E79C640]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:34.555 (   5.195s) [        4E79C640]     buffer_instance.cc:496      1| BufferInstance::PJRT_Buffer_DynamicDimensionIndices
2025-11-03 22:31:34.555 (   5.195s) [        4E79C640]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:34.555 (   5.195s) [        4E79C640]     buffer_instance.cc:465      1| BufferInstance::PJRT_Buffer_ElementType
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:484      1| BufferInstance::PJRT_Buffer_UnpaddedDimensions
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:465      1| BufferInstance::PJRT_Buffer_ElementType
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:506      1| BufferInstance::PJRT_Buffer_ToHostBuffer
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:484      1| BufferInstance::PJRT_Buffer_UnpaddedDimensions
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:465      1| BufferInstance::PJRT_Buffer_ElementType
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]     buffer_instance.cc:506      1| BufferInstance::PJRT_Buffer_ToHostBuffer
2025-11-03 22:31:34.555 (   5.195s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:35.360 (   6.000s) [        48790640]     buffer_instance.cc:350      1| Returning tensor to host; with host_runtime_tensors ct = 1 from device 0
2025-11-03 22:31:35.360 (   6.000s) [        4778E640]     buffer_instance.cc:350      1| Returning tensor to host; with host_runtime_tensors ct = 1 from device 0
2025-11-03 22:31:35.360 (   6.000s) [        47F8F640]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
2025-11-03 22:31:35.360 (   6.000s) [        49792640]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     buffer_instance.cc:457      1| BufferInstance::PJRT_Buffer_Destroy
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     buffer_instance.cc:457      1| BufferInstance::PJRT_Buffer_Destroy
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     device_instance.cc:82       1| DeviceInstance::PJRT_Device_DefaultMemory
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     client_instance.cc:660      1| ClientInstance::PJRT_Client_BufferFromHostBuffer
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     memory_instance.cc:57       1| MemoryInstance::getDevice
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
[JAMES] Calling XLAExecutor branch 1
Returning ct outputs, 1
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     buffer_instance.cc:457      1| BufferInstance::PJRT_Buffer_Destroy
2025-11-03 22:31:35.361 (   6.001s) [        6ED2D000]     buffer_instance.cc:457      1| BufferInstance::PJRT_Buffer_Destroy
2025-11-03 22:31:35.362 (   6.002s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:35.362 (   6.002s) [        6ED2D000]     buffer_instance.cc:484      1| BufferInstance::PJRT_Buffer_UnpaddedDimensions
2025-11-03 22:31:35.362 (   6.002s) [        6ED2D000]     buffer_instance.cc:465      1| BufferInstance::PJRT_Buffer_ElementType
2025-11-03 22:31:35.362 (   6.002s) [        6ED2D000]     buffer_instance.cc:473      1| BufferInstance::PJRT_Buffer_Dimensions
2025-11-03 22:31:35.362 (   6.002s) [        6ED2D000]     buffer_instance.cc:506      1| BufferInstance::PJRT_Buffer_ToHostBuffer
2025-11-03 22:31:35.362 (   6.002s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:35.362 (   6.002s) [        7F7FE640]     buffer_instance.cc:350      1| Returning tensor to host; with host_runtime_tensors ct = 1 from device 0
2025-11-03 22:31:35.362 (   6.002s) [        787F0640]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
2025-11-03 22:31:35.364 (   6.004s) [        6ED2D000]     buffer_instance.cc:558      1| BufferInstance::PJRT_Buffer_IsDeleted
2025-11-03 22:31:35.364 (   6.004s) [        6ED2D000]     buffer_instance.cc:484      1| BufferInstance::PJRT_Buffer_UnpaddedDimensions
2025-11-03 22:31:35.364 (   6.004s) [        6ED2D000]     buffer_instance.cc:465      1| BufferInstance::PJRT_Buffer_ElementType
2025-11-03 22:31:35.364 (   6.004s) [        6ED2D000]     buffer_instance.cc:506      1| BufferInstance::PJRT_Buffer_ToHostBuffer
2025-11-03 22:31:35.364 (   6.004s) [        6ED2D000]      event_instance.cc:223      1| EventInstance::PJRT_Event_OnReady
2025-11-03 22:31:35.364 (   6.004s) [        787F0640]     buffer_instance.cc:350      1| Returning tensor to host; with host_runtime_tensors ct = 1 from device 0
2025-11-03 22:31:35.364 (   6.004s) [        7F7FE640]      event_instance.cc:172      1| EventInstance::PJRT_Event_Destroy
2025-11-03 22:31:35.365 (   6.005s) [        6ED2D000]     buffer_instance.cc:457      1| BufferInstance::PJRT_Buffer_Destroy
================================================================================
COMPARISON DEBUG OUTPUT
================================================================================
Golden output shape: torch.Size([1, 32])
Device output shape: torch.Size([1, 32])
‚ö†Ô∏è  Could not perform detailed tensor analysis: Got unsupported ScalarType BFloat16
Golden output: tensor([[ 1.4609,  0.2910,  0.9609,  1.5703,  0.4941, -1.5156, -0.2500,  0.5742,
          0.3262, -0.5664,  0.5430, -0.5625,  0.6016,  2.3750,  1.6719, -0.8359,
         -0.5039, -0.5078, -0.4355,  1.3672, -0.6719, -0.1108,  0.8945, -1.3359,
          0.7656,  1.1484, -0.5742,  0.9609,  2.0312,  0.5625,  0.2002, -0.6992]],
       dtype=torch.bfloat16)
Device output: tensor([[ 1.4531,  0.2930,  0.9570,  1.5625,  0.4922, -1.5078, -0.2490,  0.5781,
          0.3281, -0.5703,  0.5391, -0.5586,  0.5977,  2.3594,  1.6641, -0.8320,
         -0.5000, -0.5039, -0.4336,  1.3594, -0.6680, -0.1104,  0.8906, -1.3281,
          0.7617,  1.1406, -0.5703,  0.9570,  2.0156,  0.5664,  0.1992, -0.6953]],
       device='xla:0', dtype=torch.bfloat16)

üîç PCC Analysis: ‚úì PASS
   Calculated PCC: 1.000000
   Required PCC:   0.990000

üìè ATOL: ‚úì 0.015625 (req: 0.160000)
üîç Equal: ‚úó False
üìê Allclose: ‚úì True
================================================================================
PASSED

============================== 1 passed in 8.44s ===============================
2025-11-03 22:31:36.650 (   7.290s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
2025-11-03 22:31:36.650 (   7.290s) [        6ED2D000]  device_description.cc:44       1| DeviceDescription::PJRT_DeviceDescription_Id
